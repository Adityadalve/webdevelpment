DECLARE @json NVARCHAR(MAX) = ?;  -- full JSON payload

INSERT INTO STG.SURV_FXSPOT_TRADE
(
    tradeExecutionDateTime,
    sourceAttributes,
    enrichments,
    tradeEvents,
    executionVenueMic,
    product,
    tradeRelationships,
    recordInsertedTime,
    recordEffectiveTime,
    intentToClear,
    recordStatus,
    tradingPlatformName,
    packagePriceCurrency,
    packagePriceNotation,
    packagePrice,
    packagePriceType,
    fees,
    effectiveDate,
    tradeDate,
    brokerId,
    tradeExecutionVenueType,
    tradeExecutionMethod,
    tradingPlatformTradeId,
    inScopeForAllocation,
    packageSize,
    salesPersonAcf2,
    executionSystemTradeId,
    counterpartyCode,
    traderAcf2,
    bookName,
    version,
    systemName,
    tradeExecutionSourceSystem,
    tradeSettlementSourceSystem,
    tradeId,
    calculationAgent,
    preTradeSourceSystem,
    preTradeSystemRecordID,
    tradeIdInternal,
    packageId,
    blockTradeState,
    packageType,
    cashSettlementChannel,
    salesMarginAmount,
    salesMarginCurrency,
    salesRevenueAgreement,
    tradeIdOriginal,
    recordUuid,
    recordMetadata
)
SELECT
    JSON_VALUE(@json,'$.tradeExecutionDateTime'),
    JSON_QUERY(@json,'$.sourceAttributes'),
    JSON_QUERY(@json,'$.enrichments'),
    JSON_QUERY(@json,'$.tradeEvents'),
    JSON_VALUE(@json,'$.executionVenueMic'),
    JSON_QUERY(@json,'$.product'),
    JSON_QUERY(@json,'$.tradeRelationships'),
    JSON_VALUE(@json,'$.recordInsertedTime'),
    JSON_VALUE(@json,'$.recordEffectiveTime'),
    CASE JSON_VALUE(@json,'$.intentToClear') WHEN 'true' THEN 1 ELSE 0 END,
    JSON_VALUE(@json,'$.recordStatus'),
    JSON_VALUE(@json,'$.tradingPlatformName'),
    JSON_VALUE(@json,'$.packagePriceCurrency'),
    JSON_VALUE(@json,'$.packagePriceNotation'),
    JSON_VALUE(@json,'$.packagePrice'),
    JSON_VALUE(@json,'$.packagePriceType'),
    JSON_QUERY(@json,'$.fees'),
    JSON_VALUE(@json,'$.effectiveDate'),
    JSON_VALUE(@json,'$.tradeDate'),
    JSON_VALUE(@json,'$.brokerId'),
    JSON_VALUE(@json,'$.tradeExecutionVenueType'),
    JSON_VALUE(@json,'$.tradeExecutionMethod'),
    JSON_VALUE(@json,'$.tradingPlatformTradeId'),
    JSON_VALUE(@json,'$.inScopeForAllocation'),
    JSON_VALUE(@json,'$.packageSize'),
    JSON_VALUE(@json,'$.salesPersonAcf2'),
    JSON_VALUE(@json,'$.executionSystemTradeId'),
    JSON_VALUE(@json,'$.counterpartyCode'),
    JSON_VALUE(@json,'$.traderAcf2'),
    JSON_VALUE(@json,'$.bookName'),
    JSON_VALUE(@json,'$.version'),
    JSON_VALUE(@json,'$.systemName'),
    JSON_VALUE(@json,'$.tradeExecutionSourceSystem'),
    JSON_VALUE(@json,'$.tradeSettlementSourceSystem'),
    JSON_VALUE(@json,'$.tradeId'),
    JSON_VALUE(@json,'$.calculationAgent'),
    JSON_VALUE(@json,'$.preTradeSourceSystem'),
    JSON_VALUE(@json,'$.preTradeSystemRecordID'),
    JSON_VALUE(@json,'$.tradeIdInternal'),
    JSON_VALUE(@json,'$.packageId'),
    JSON_VALUE(@json,'$.blockTradeState'),
    JSON_VALUE(@json,'$.packageType'),
    JSON_VALUE(@json,'$.cashSettlementChannel'),
    JSON_VALUE(@json,'$.salesMarginAmount'),
    JSON_VALUE(@json,'$.salesMarginCurrency'),
    JSON_VALUE(@json,'$.salesRevenueAgreement'),
    JSON_VALUE(@json,'$.tradeIdOriginal'),
    JSON_VALUE(@json,'$.recordUuid'),
    JSON_QUERY(@json,'$.recordMetadata');